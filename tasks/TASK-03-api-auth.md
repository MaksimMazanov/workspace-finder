# TASK-03: API Auth (JWT)

**Приоритет:** MEDIUM  
**Статус:** TODO  
**Зависимости:** TASK-01 (LoginPage)  
**Время выполнения:** ~1.5 часа  

## Описание

Реализовать простой backend на Express.js с мок‑данными пользователей и JWT‑аутентификацией.  
API должно уметь: регистрировать пользователя, логинить по email/паролю, выдавать JWT и проверять его на защищённых маршрутах.

## Технические требования

### 1. Моковые пользователи

- Хранить пользователей в памяти (массива достаточно): `email`, `password` (plain для простоты), `id`.  
- Разрешить регистрацию только с уникальным `email`.

### 2. Эндпоинты Express (`stubs/api/index.js`)

**POST `/api/auth/register`**  
- Вход: `{ email: string, password: string }`.  
- Валидация: корректный email, пароль ≥ 6 символов.  
- При успехе создаёт мок‑пользователя и возвращает `{ token }`.

**POST `/api/auth/login`**  
- Вход: `{ email: string, password: string }`.  
- Ищет пользователя в мок‑массиве и сравнивает пароль.  
- При успехе генерирует JWT и возвращает `{ token }`.  
- При ошибке возвращает 401 с сообщением.

**GET `/api/auth/me`**  
- Требует заголовок `Authorization: Bearer <token>`.  
- Проверяет JWT через middleware `verifyToken`.  
- При успехе возвращает текущего пользователя `{ id, email }`.

### 3. JWT

- Секрет хранить в `.env` или константе `JWT_SECRET` (для задачи достаточно константы).  
- Срок жизни токена, например, `1h`.  
- Payload минимум: `{ userId }`.

### 4. Frontend интеграция (`src/pages/login/login.tsx`)

- LoginPage из TASK‑01 продолжает отправлять POST `/api/auth/login` и сохранять `accessToken` в `localStorage`.  
- Приватные роуты читают `accessToken` и для проверки вызывают `GET /api/auth/me`.

## Критерии приёмки

- `POST /api/auth/register` создаёт нового пользователя и возвращает JWT.  
- `POST /api/auth/login` для корректных email/пароля возвращает JWT.  
- `GET /api/auth/me` с валидным токеном возвращает данные пользователя, с невалидным — 401.  
- LoginPage работает с `email + password`, сохраняет `accessToken` и использует его для доступа к защищённым страницам.
